<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>University Project Form</title>
  <style>
    body { font-family: sans-serif; background: #f9f9f9; padding: 20px; }
    form { max-width: 900px; margin: auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 0 10px rgba(0,0,0,0.1); }
    label { display: block; margin-top: 10px; }
    input, textarea, select { width: 100%; padding: 8px; margin-top: 4px; border: 1px solid #ccc; border-radius: 4px; }
    button { margin-top: 20px; padding: 10px 20px; background: #007acc; color: white; border: none; border-radius: 4px; cursor: pointer; }
  </style>
</head>
<body>

<h1 style="text-align:center;">University Project Submission</h1>

<form id="projectForm">
  <label>Project Type: <select name="projectType"><option>Research</option><option>Capacity Building</option></select></label>
  <label>Project No.: <input name="projectNo" required /></label>
  <label>Project Title: <textarea name="projectTitle" rows="3" required></textarea></label>
  <label>Start Date: <input type="date" name="startDate" required /></label>
  <label>End Date: <input type="date" name="endDate" required /></label>
  <label>Funding Program/Entity: <input name="funding" /></label>
  <label>Partners (comma-separated): <textarea name="partners"></textarea></label>
  <label>Currency: <input name="currency" /></label>
  <label>Total Budget: <input name="totalBudget" /></label>
  <label>University Share: <input name="universityShare" /></label>
  <label>Project Manager: <input name="projectManager" /></label>
  <label>University Project Coord: <input name="universityCoord" /></label>
  <label>University Project Team (comma-separated): <textarea name="projectTeam"></textarea></label>
  <label>Project Brief: <textarea name="projectBrief"></textarea></label>
  <label>Project Status: <select name="projectStatus"><option>Ongoing</option><option>Finished</option><option>Suspended</option><option>Exit</option></select></label>
  <label>Achievement Stages: <textarea name="achievementStages"></textarea></label>
  <label>Result (Paper, Report, etc.): <textarea name="result"></textarea></label>
  <label>Acronym: <input name="acronym" /></label>
  <label>Website: <input name="website" /></label>
  <label>Notes: <textarea name="notes"></textarea></label>
  <button type="submit">Submit</button>
</form>

<script>
document.getElementById('projectForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const form = e.target;
  const data = Object.fromEntries(new FormData(form));
  fetch("https://script.google.com/macros/s/AKfycbywngMyMwKpM3Xv9QhC5bFpMDdLf--7e-ALAmYCzyPxZ-DOWVyYsmGOa4qydBfB_yrOcQ/exec", {
    method: "POST",
    body: JSON.stringify(data),
    headers: { "Content-Type": "application/json" }
  })
  .then(res => res.text())
  .then(msg => {
    alert("Submitted successfully!");
    form.reset();
  })
  .catch(err => {
    alert("Error: " + err.message);
  });
});
</script>

</body>
</html>
